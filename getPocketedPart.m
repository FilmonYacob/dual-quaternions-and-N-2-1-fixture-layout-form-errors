function [Vs, FFs,flatness] = getPocketedPart()
% clear; close all;
% rng(2025)
for i = 1:10
    %     Z = csvread(strcat('randomFiledCurved', num2str(i-1), '.csv'));
    %     Z(:, 1) = []; Z(1, :) = [];
    %     [X, Y] = meshgrid(1:50, 1:50);
    %     surf2stl(strcat('randomdField_feature_', num2str(i-1),'.stl'),X,Y,Z);

 
    [F, V] = stlread(strcat('randomdField_feature_', num2str(i-1), '.stl'));
%     flatness{i} = max(V(:,3))-min(V(:,3));
    Vs{i} = [V(:, 1), V(:, 2), V(:, 3)*0]*4;
    FFs{i} = F;
end

Vs = createStock(Vs, FFs);
Vs{10} = Vs{10}+[0 0 -15];
Vs{4} = Vs{4}+[0 0 -15];
% Vs = createFinalPart(FFs, Vs);
function Vs = createFinalPart(FFs, Vs)
% creates a stock
Vs{1} = [Vs{1}(:, 1), Vs{1}(:, 2), Vs{1}(:, 3)];
Vs{2} = [Vs{2}(:, 1), Vs{2}(:, 2), Vs{2}(:, 3)] + [0, 0, 120];
Vs{2} = Vs{2}(~((Vs{2}(:, 1) >= 40) & (Vs{2}(:, 1) <= 160) & (Vs{2}(:, 2) >= 40) & (Vs{2}(:, 2) <= 160)), :);
Vs{3} = [Vs{3}(:, 1), Vs{3}(:, 2), Vs{3}(:, 3)] + [0, 0, 100];
Vs{3} = Vs{3}(((Vs{3}(:, 1) >= 40) & (Vs{3}(:, 1) <= 160) & (Vs{3}(:, 2) >= 40) & (Vs{3}(:, 2) <= 160)), :);
Vs{4} = [Vs{4}(:, 1), Vs{4}(:, 2), Vs{4}(:, 3)] * rotx(-90, 'deg');
Vs{4} = Vs{4}((Vs{4}(:, 3) <= 120), :);
Vs{5} = [Vs{5}(:, 1), Vs{5}(:, 2), Vs{5}(:, 3)] * roty(90, 'deg');
Vs{5} = Vs{5}((Vs{5}(:, 3) <= 120), :);
Vs{6} = [Vs{6}(:, 1), Vs{6}(:, 2), Vs{6}(:, 3)] * rotx(-90, 'deg') + [0, 200, 0];
Vs{6} = Vs{6}((Vs{6}(:, 3) <= 120), :);
Vs{7} = [Vs{7}(:, 1), Vs{7}(:, 2), Vs{7}(:, 3)] * roty(90, 'deg') + [200, 0, 0];
Vs{7} = Vs{7}((Vs{7}(:, 3) <= 120), :);
Vs{8} = [Vs{8}(:, 1), Vs{8}(:, 2), Vs{8}(:, 3)] * roty(90, 'deg') + [40, 0, 0];
Vs{8} = Vs{8}((Vs{8}(:, 3) <= 119.5) & (Vs{8}(:, 3) >= 110) & ...
(Vs{8}(:, 2) >= 40) & (Vs{8}(:, 2) <= 160), :);
Vs{9} = [Vs{9}(:, 1), Vs{9}(:, 2), Vs{9}(:, 3)] * roty(90, 'deg') + [160, 0, 0];
Vs{9} = Vs{9}((Vs{9}(:, 3) <= 119.5) & (Vs{9}(:, 3) >= 110) & ...
(Vs{9}(:, 1) >= 160) & (Vs{9}(:, 2) <= 160) & (Vs{9}(:, 2) >= 40), :);
Vs{10} = [Vs{10}(:, 1), Vs{10}(:, 2), Vs{10}(:, 3)] * rotx(-90, 'deg') + [0, 40, 0];
Vs{10} = Vs{10}((Vs{10}(:, 3) <= 119.5) & (Vs{10}(:, 3) >= 110) & ...
(Vs{10}(:, 1) <= 160) & (Vs{10}(:, 1) >= 40), :);
Vs{11} = Vs{10} + [0, 120, 0];
end

%%
function Vs = createStock(Vs, FFs)
% creates a stock
Vs{1} = [Vs{1}(:, 1), Vs{1}(:, 2), Vs{1}(:, 3)]+[0, 0, 120] ; %S1
Vs{2} = [Vs{2}(:, 1), Vs{2}(:, 2), Vs{2}(:, 3)]; % S0
Vs{3} = [Vs{3}(:, 1), Vs{3}(:, 2), Vs{3}(:, 3)] + [0, 0, 20]; % S3
Vs{4} = [Vs{4}(:, 1), Vs{4}(:, 2), Vs{4}(:, 3)] * rotx(-90, 'deg'); %S5
Vs{5} = [Vs{5}(:, 1), Vs{5}(:, 2), Vs{5}(:, 3)] * roty(90, 'deg'); % S4
Vs{6} = [Vs{6}(:, 1), Vs{6}(:, 2), Vs{6}(:, 3)] * rotx(-90, 'deg') + [0, 200, 0];
Vs{7} = [Vs{7}(:, 1), Vs{7}(:, 2), Vs{7}(:, 3)] * roty(90, 'deg') + [200, 0, 0];
Vs{8} = [Vs{8}(:, 1), Vs{8}(:, 2), Vs{8}(:, 3)] * roty(90, 'deg') + [40, 0, 0];
Vs{9} = [Vs{9}(:, 1), Vs{9}(:, 2), Vs{9}(:, 3)] * roty(90, 'deg') + [160, 0, 0];
Vs{10} = [Vs{10}(:, 1), Vs{10}(:, 2), Vs{10}(:, 3)] * rotx(-90, 'deg') + [0, 40, 0];
Vs{11} = Vs{10} + [0, 120, 0];
Vs{12} = [0, 200, 120];
end
end